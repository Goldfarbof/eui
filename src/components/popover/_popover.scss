// SOME NOTES
// SOME NOTES
// SOME NOTES
// SOME NOTES

// Because of the animations and positioning involved, this code gets pretty
// repetitive. What you generally need to know if you work in here is that
// the positioning of the popovers (and the arrows attached to them)
// is handled through absolute positioning and then animated through the use
// of transforms.

.kuiPopover {
  display: inline-block;
  position: relative;

  // Open state happens on the wrapper and applies to the panel.
  &.kuiPopover-isOpen {
    .kuiPopover__panel {
      opacity: 1;
      visibility: visible;
      z-index: $euiZContentMenu;
      pointer-events: auto;
    }
  }
}

  // Animation happens on the panel.
  .kuiPopover__panel {
    position: absolute;
    min-width: $euiSize * 16; // Can expand further, but this size is good for our menus.
    backface-visibility: hidden;
    transition:
      opacity $euiAnimSlightBounce $euiAnimSpeedSlow,
      visibility $euiAnimSlightBounce $euiAnimSpeedSlow,
      transform $euiAnimSlightBounce $euiAnimSpeedSlow;
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
    transform: translateY(0) translateZ(0);

    // This fakes a border on the arrow.
    &:before {
      position: absolute;
      content: "";
      height: 0;
      width: 0;
    }

    // This part of the arrow matches the panel.
    &:after {
      position: absolute;
      content: "";
      height: 0;
      width: 0;
    }
  }

// Anchor DOWN
// Anchor DOWN
// Anchor DOWN
// Anchor DOWN
// Anchor DOWN

.kuiPopover--withTitle.kuiPopover--anchorDownCenter .kuiPopover__panel:after,
.kuiPopover--withTitle.kuiPopover--anchorDownLeft .kuiPopover__panel:after,
.kuiPopover--withTitle.kuiPopover--anchorDownRight .kuiPopover__panel:after
{
  border-bottom-color: $euiColorLightestShade;
}

.kuiPopover--anchorDownCenter.kuiPopover-isOpen .kuiPopover__panel {
  transform: translateX(-50%) translateY($euiSizeS) translateZ(0);
}

.kuiPopover--anchorDownLeft.kuiPopover-isOpen .kuiPopover__panel {
  transform: translateX(0%) translateY($euiSizeS) translateZ(0);
}

.kuiPopover--anchorDownRight.kuiPopover-isOpen .kuiPopover__panel {
  transform: translateX(-100%) translateY($euiSizeS) translateZ(0);
}

.kuiPopover--anchorDownCenter {
  .kuiPopover__panel {
    left: 50%;
    top: 100%;
    transform: translateX(-50%) translateY($euiSizeL) translateZ(0);

    &:before {
      top: -$euiSize;
      left: 50%;
      margin-left: -$euiSize;
      border-left: $euiSize solid transparent;
      border-right: $euiSize solid transparent;
      border-bottom: $euiSize solid $euiBorderColor;
    }

    &:after {
      top: -$euiSize + 1;
      right: 0;
      left: 50%;
      margin-left: -$euiSize;
      border-left: $euiSize solid transparent;
      border-right: $euiSize solid transparent;
      border-bottom: $euiSize solid $euiColorEmptyShade;
    }
  }
}

// Positions the menu and arrow to the left of the parent.
.kuiPopover--anchorDownLeft {
  .kuiPopover__panel {
    left: 0;
    transform: translateX(0%) translateY($euiSizeL) translateZ(0);

    &:before {
      top: -$euiSize;
      border-left: $euiSize solid transparent;
      border-right: $euiSize solid transparent;
      border-bottom: $euiSize solid $euiBorderColor;
      right: auto;
      left: $euiSize;
    }

    &:after {
      top: -$euiSize + 1;
      border-left: $euiSize solid transparent;
      border-right: $euiSize solid transparent;
      border-bottom: $euiSize solid $euiColorEmptyShade;
      right: auto;
      left: $euiSize;
    }
  }
}

// Positions the menu and arrow to the right of the parent.
.kuiPopover--anchorDownRight {
  .kuiPopover__panel {
    left: 100%;
    transform: translateX(-100%) translateY($euiSizeL) translateZ(0);

    &:before {
      top: -$euiSize;
      margin-left: -$euiSize;
      border-left: $euiSize solid transparent;
      border-right: $euiSize solid transparent;
      border-bottom: $euiSize solid $euiBorderColor;
      right: $euiSize;
      left: auto;
    }

    &:after {
      top: -$euiSize + 1;
      margin-left: -$euiSize;
      border-left: $euiSize solid transparent;
      border-right: $euiSize solid transparent;
      border-bottom: $euiSize solid $euiColorEmptyShade;
      right: $euiSize;
      left: auto;
    }
  }
}


// Anchor UP
// Anchor UP
// Anchor UP
// Anchor UP
// Anchor UP

.kuiPopover--anchorUpCenter.kuiPopover-isOpen .kuiPopover__panel {
  transform: translateX(-50%) translateY(-$euiSizeS) translateZ(0);
}

.kuiPopover--anchorUpLeft.kuiPopover-isOpen .kuiPopover__panel {
  transform: translateX(0%) translateY(-$euiSizeS) translateZ(0);
}

.kuiPopover--anchorUpRight.kuiPopover-isOpen .kuiPopover__panel {
  transform: translateX(-100%) translateY(-$euiSizeS) translateZ(0);
}

.kuiPopover--anchorUpCenter {
  .kuiPopover__panel {
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%) translateY(-$euiSizeL) translateZ(0);

    &:before {
      bottom: -$euiSize;
      left: 50%;
      margin-left: -$euiSize;
      border-left: $euiSize solid transparent;
      border-right: $euiSize solid transparent;
      border-top: $euiSize solid $euiBorderColor;
    }

    &:after {
      bottom: -$euiSize + 1;
      right: 0;
      left: 50%;
      margin-left: -$euiSize;
      border-left: $euiSize solid transparent;
      border-right: $euiSize solid transparent;
      border-top: $euiSize solid $euiColorEmptyShade;
    }
  }
}

// Positions the menu and arrow to the left of the parent.
.kuiPopover--anchorUpLeft {
  .kuiPopover__panel {
    bottom: 100%;
    left: 0;
    transform: translateX(0%) translateY(-$euiSizeL) translateZ(0);

    &:before {
      bottom: -$euiSize;
      border-left: $euiSize solid transparent;
      border-right: $euiSize solid transparent;
      border-top: $euiSize solid $euiBorderColor;
      right: auto;
      left: $euiSize;
    }

    &:after {
      bottom: -$euiSize + 1;
      border-left: $euiSize solid transparent;
      border-right: $euiSize solid transparent;
      border-top: $euiSize solid $euiColorEmptyShade;
      right: auto;
      left: $euiSize;
    }
  }
}

// Positions the menu and arrow to the right of the parent.
.kuiPopover--anchorUpRight {
  .kuiPopover__panel {
    bottom: 100%;
    left: 100%;
    transform: translateX(-100%) translateY(-$euiSizeL) translateZ(0);

    &:before {
      bottom: -$euiSize;
      margin-left: -$euiSize;
      border-left: $euiSize solid transparent;
      border-right: $euiSize solid transparent;
      border-top: $euiSize solid $euiBorderColor;
      right: $euiSize;
      left: auto;
    }

    &:after {
      bottom: -$euiSize + 1;
      margin-left: -$euiSize;
      border-left: $euiSize solid transparent;
      border-right: $euiSize solid transparent;
      border-top: $euiSize solid $euiColorEmptyShade;
      right: $euiSize;
      left: auto;
    }
  }
}

// Anchor LEFT
// Anchor LEFT
// Anchor LEFT
// Anchor LEFT
// Anchor LEFT

.kuiPopover--withTitle.kuiPopover--anchorLeftCenter .kuiPopover__panel:after,
.kuiPopover--withTitle.kuiPopover--anchorLeftUp .kuiPopover__panel:after,
.kuiPopover--withTitle.kuiPopover--anchorLeftDown .kuiPopover__panel:after
{
  border-left-color: $euiColorLightestShade;
}

.kuiPopover--withTitle.kuiPopover--anchorLeftUp .kuiPopover__panel {
  top: 0;

  &:before {
    top: $euiSizeXS;
  }

  &:after {
    top: $euiSizeXS;
  }
}

.kuiPopover--anchorLeftCenter.kuiPopover-isOpen .kuiPopover__panel {
  transform: translateX(-$euiSizeS) translateY(-50%) translateZ(0);
}

.kuiPopover--anchorLeftUp.kuiPopover-isOpen .kuiPopover__panel {
  transform: translateX(-$euiSizeS) translateY(0) translateZ(0);
}

.kuiPopover--anchorLeftDown.kuiPopover-isOpen .kuiPopover__panel {
  transform: translateX(-$euiSizeS) translateY(-100%) translateZ(0);
}

.kuiPopover--anchorLeftCenter {
  .kuiPopover__panel {
    top: 50%;
    right: 100%;
    transform: translateX(-$euiSizeL) translateY(-50%) translateZ(0);

    &:before {
      right: -$euiSize;
      top: 50%;
      margin-top: -$euiSize;
      border-top: $euiSize solid transparent;
      border-bottom: $euiSize solid transparent;
      border-left: $euiSize solid $euiBorderColor;
    }

    &:after {
      right: -$euiSize + 1;
      top: 50%;
      margin-top: -$euiSize;
      border-top: $euiSize solid transparent;
      border-bottom: $euiSize solid transparent;
      border-left: $euiSize solid $euiColorEmptyShade;
    }
  }
}

// Positions the menu and arrow to the left of the parent.
.kuiPopover--anchorLeftUp {
  .kuiPopover__panel {
    top: -$euiSizeM;
    right: 100%;
    transform: translateX(-$euiSizeL) translateY(0) translateZ(0);

    &:before {
      right: -$euiSize;
      top: $euiSize;
      border-top: $euiSize solid transparent;
      border-bottom: $euiSize solid transparent;
      border-left: $euiSize solid $euiBorderColor;
    }

    &:after {
      right: -$euiSize + 1;
      top: $euiSize;
      border-top: $euiSize solid transparent;
      border-bottom: $euiSize solid transparent;
      border-left: $euiSize solid $euiColorEmptyShade;
    }
  }
}

// Positions the menu and arrow to the right of the parent.
.kuiPopover--anchorLeftDown {
  .kuiPopover__panel {
    top: calc(100% + #{$euiSizeM});
    right: 100%;
    transform: translateX(-$euiSizeL) translateY(-100%) translateZ(0);

    &:before {
      right: -$euiSize;
      bottom: $euiSize;
      border-top: $euiSize solid transparent;
      border-bottom: $euiSize solid transparent;
      border-left: $euiSize solid $euiBorderColor;
    }

    &:after {
      right: -$euiSize + 1;
      bottom: $euiSize;
      border-top: $euiSize solid transparent;
      border-bottom: $euiSize solid transparent;
      border-left: $euiSize solid $euiColorEmptyShade;
    }
  }
}

// Anchor RIGHT
// Anchor RIGHT
// Anchor RIGHT
// Anchor RIGHT
// Anchor RIGHT

.kuiPopover--withTitle.kuiPopover--anchorRightCenter .kuiPopover__panel:after,
.kuiPopover--withTitle.kuiPopover--anchorRightUp .kuiPopover__panel:after,
.kuiPopover--withTitle.kuiPopover--anchorRightDown .kuiPopover__panel:after
{
  border-right-color: $euiColorLightestShade;
}

.kuiPopover--withTitle.kuiPopover--anchorRightUp .kuiPopover__panel {
  top: 0;

  &:before {
    top: $euiSizeXS;
  }

  &:after {
    top: $euiSizeXS;
  }
}

.kuiPopover--anchorRightCenter.kuiPopover-isOpen .kuiPopover__panel {
  transform: translateX($euiSizeS) translateY(-50%) translateZ(0);
}

.kuiPopover--anchorRightUp.kuiPopover-isOpen .kuiPopover__panel {
  transform: translateX($euiSizeS) translateY(0) translateZ(0);
}

.kuiPopover--anchorRightDown.kuiPopover-isOpen .kuiPopover__panel {
  transform: translateX($euiSizeS) translateY(-100%) translateZ(0);
}

.kuiPopover--anchorRightCenter {
  .kuiPopover__panel {
    top: 50%;
    left: 100%;
    transform: translateX($euiSizeL) translateY(-50%) translateZ(0);

    &:before {
      left: -$euiSize;
      top: 50%;
      margin-top: -$euiSize;
      border-top: $euiSize solid transparent;
      border-bottom: $euiSize solid transparent;
      border-right: $euiSize solid $euiBorderColor;
    }

    &:after {
      left: -$euiSize + 1;
      top: 50%;
      margin-top: -$euiSize;
      border-top: $euiSize solid transparent;
      border-bottom: $euiSize solid transparent;
      border-right: $euiSize solid $euiColorEmptyShade;
    }
  }
}

// Positions the menu and arrow to the left of the parent.
.kuiPopover--anchorRightUp {
  .kuiPopover__panel {
    top: -$euiSizeM;
    left: 100%;
    transform: translateX($euiSizeL) translateY(0) translateZ(0);

    &:before {
      left: -$euiSize;
      top: $euiSize;
      border-top: $euiSize solid transparent;
      border-bottom: $euiSize solid transparent;
      border-right: $euiSize solid $euiBorderColor;
    }

    &:after {
      left: -$euiSize + 1;
      top: $euiSize;
      border-top: $euiSize solid transparent;
      border-bottom: $euiSize solid transparent;
      border-right: $euiSize solid $euiColorEmptyShade;
    }
  }
}

// Positions the menu and arrow to the right of the parent.
.kuiPopover--anchorRightDown {
  .kuiPopover__panel {
    top: calc(100% + #{$euiSizeM});
    left: 100%;
    transform: translateX($euiSizeL) translateY(-100%) translateZ(0);

    &:before {
      left: -$euiSize;
      bottom: $euiSize;
      border-top: $euiSize solid transparent;
      border-bottom: $euiSize solid transparent;
      border-right: $euiSize solid $euiBorderColor;
    }

    &:after {
      left: -$euiSize + 1;
      bottom: $euiSize;
      border-top: $euiSize solid transparent;
      border-bottom: $euiSize solid transparent;
      border-right: $euiSize solid $euiColorEmptyShade;
    }
  }
}
